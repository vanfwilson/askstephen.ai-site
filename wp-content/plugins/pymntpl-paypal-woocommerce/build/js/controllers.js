/*! For license information please see controllers.js.LICENSE.txt */
(()=>{"use strict";var t={863:(t,e,n)=>{n.d(e,{getErrorMessage:()=>r}),n(819),n(567),window.wp.hooks,new Map;var r=function(t){var e,n=(e="errorMessages",void 0!==window.wcPPCPSettings&&window.wcPPCPSettings[e]||{});return"string"==typeof t?t:null!=t&&t.code&&null!=n&&n[t.code]?n[t.code]:null!=t&&t.message?t.message:void 0};Error},567:t=>{t.exports=window.jQuery},819:t=>{t.exports=window.lodash}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{n.r(r),n.d(r,{BaseController:()=>P,CartController:()=>q,CheckoutController:()=>rt,ExpressCheckoutController:()=>yt,MiniCartController:()=>Et,ProductController:()=>L});var t=n(567),e=n.n(t);const i=window.wp.apiFetch;var o=n.n(i);const a=window.wcPPCP.utils;var c=n(819),u=["email","phone"],s=["phone"];function l(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}const d=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.controller=n}var n,r;return n=t,r=[{key:"populate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(this.context.isCheckout()||this.context.isExpressCheckout())&&this.syncDOMToMap(e),null!=t&&t.billing&&this.populateBilling(t.billing,e),null!=t&&t.shipping&&!e.skipShipping&&e.needsShipping&&this.populateShipping(t.shipping,e)}},{key:"syncDOMToMap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=["first_name","last_name","company","address_1","address_2","city","state","postcode","country","email","phone"];if(n.forEach((function(t){var n=e()('[name="billing_'.concat(t,'"]'));n.length&&(0,a.setFieldValue)(t,n.val(),"billing")})),t.needsShipping){var r=["first_name","last_name","company","address_1","address_2","city","state","postcode","country","phone"];r.forEach((function(t){var n=e()('[name="shipping_'.concat(t,'"]'));n.length&&(0,a.setFieldValue)(t,n.val(),"shipping")}))}}},{key:"populateBilling",value:function(t,n){var r=this,i=t.email,o=t.phone,s=l(t,u);(0,c.isEmpty)(s)||(this.context.isCheckout()||this.context.isExpressCheckout()?(0,a.isValidAddress)(s,["first_name","last_name","phone"])&&!(0,c.isEqual)(this.controller.getCartAddress("billing",!0),(0,c.omit)(s,["first_name","last_name"]))&&(this.controller.update_required=!0,this.populateAddressFields(s,"billing"),e()(document.body).one("updated_checkout",(function(){r.populateAddressFields(s,"billing")}))):this.populateAddressFields(s,"billing")),i&&(this.context.isCheckout()&&(0,a.isValid)("billing_email")||(0,a.setFieldValue)("billing_email",i)),o&&((0,a.setFieldValue)("billing_phone",o),n.needsShipping&&(0,a.setFieldValue)("shipping_phone",o))}},{key:"populateShipping",value:function(t,n){var r=this,i=t.phone,o=l(t,s);if(!(0,c.isEmpty)(o))if(this.context.isCheckout()||this.context.isExpressCheckout()){var u=this.controller.getCartFullAddress("shipping",!0);(0,c.isEqual)(u,o)||(this.controller.update_required=!0,this.populateAddressFields(o,"shipping"),e()(document.body).one("updated_checkout",(function(){r.populateAddressFields(o,"shipping")}))),(0,a.isValidAddress)(this.controller.getCartFullAddress("billing",!0),["phone","email"])||(o.first_name&&o.last_name&&!(0,a.isValid)("billing_first_name")&&!(0,a.isValid)("billing_last_name")&&((0,a.setFieldValue)("first_name",o.first_name,"billing"),(0,a.setFieldValue)("last_name",o.last_name,"billing")),this.populateAddressFields(o,"billing"))}else this.populateAddressFields(o,"shipping"),(0,a.isValidAddress)(this.controller.getCartFullAddress("billing",!0),["phone","email"])||this.populateAddressFields(o,"billing");i&&(0,a.setFieldValue)("shipping_phone",i),(this.context.isCheckout()||this.context.isExpressCheckout())&&this.maybeShipToDifferentAddress()}},{key:"maybeShipToDifferentAddress",value:function(){var t;if(null!==(t=e()('[name="ship_to_different_address"]'))&&void 0!==t&&t.length){var n=this.controller.getCartFullAddress("billing"),r=this.controller.getCartFullAddress("shipping"),i=!(0,c.isEqual)(n,r);e()('[name="ship_to_different_address"]').prop("checked",i).trigger("change")}}},{key:"populateAddressFields",value:function(t,e){for(var n in t)(0,a.setFieldValue)(n,t[n],e)}}],r&&h(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(),p=window.wcPPCP.actions;var f=n.n(p);function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){k(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(){g=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof h?e:h,o=Object.create(i.prototype),a=new O(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var c=k(a,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=s(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function s(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var l={};function h(){}function d(){}function p(){}var f={};c(f,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(x([])));m&&m!==e&&n.call(m,i)&&(f=m);var b=p.prototype=h.prototype=Object.create(f);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(i,o,a,c){var u=s(t[i],t,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==y(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;this._invoke=function(t,n){function o(){return new e((function(e,i){r(t,n,e,i)}))}return i=i?i.then(o,o):o()}}function k(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=s(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function x(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return d.prototype=p,c(b,"constructor",p),c(p,"constructor",d),d.displayName=c(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,a,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},w(_.prototype),c(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new _(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(b),c(b,a,"Generator"),c(b,i,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=x,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:x(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function b(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function w(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){b(o,r,i,a,c,"next",t)}function c(t){b(o,r,i,a,c,"throw",t)}a(void 0)}))}}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var P=function(){function t(e){var n=e.id,r=e.settings,i=e.cart,o=e.context,a=e.gateway,c=e.container,u=void 0===c?null:c,s=e.paymentElementSelector,l=void 0===s?null:s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=n,this.cart=i,this.gateway=a,this.context=o,this.settings=r,this.container=u||"li.payment_method_".concat(n),this.paymentElementSelector=l,this.order_field_key=a.getOrderFieldKey(),this.billing_token_key=a.getTokenFieldKey(),this.isPaymentMethodAvailable=!0,this.fields=new d(this.context,this),this.actions=new(f()),this.gateway.setController(this),this.gateway.initialize()}var n,r,i,c;return n=t,r=[{key:"initialize",value:function(){var t=this;this.loadPayPalScript().then(w(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.createPaymentElement();case 2:case"end":return e.stop()}}),e)}))))}},{key:"loadPayPalScript",value:function(){var t=this;return new Promise((function(e,n){(0,a.loadPayPalSdk)(t.getPayPalSDKArgs()).then((function(n){t.paypal=n,t.gateway.setPayPal(n),e()})).catch((function(e){console.log(e),null!=e&&e.code&&t.submitError((0,a.getErrorMessage)(e)),n()}))}))}},{key:"getPayPalSDKArgs",value:function(){return(0,a.getPayPalQueryParams)()}},{key:"createPaymentElement",value:(c=w(g().mark((function t(){var n,r,i,o;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.configurationError=null,this.cart.isPaymentMethodAvailable(this.gateway.id)){t.next=5;break}return this.isPaymentMethodAvailable=!1,this.onPaymentUnavailable(),t.abrupt("return");case 5:return n=!1,t.prev=6,t.next=9,this.gateway.canMakePayment();case 9:n=t.sent,t.next=16;break;case 12:t.prev=12,t.t0=t.catch(6),n=!1,t.t0 instanceof a.ConfigurationError?this.configurationError=t.t0.message:console.error("Payment method availability check failed:",t.t0);case 16:if(n){t.next=20;break}return this.isPaymentMethodAvailable=!1,this.configurationError&&this.onPaymentUnavailable(),t.abrupt("return");case 20:if(this.isPaymentMethodAvailable=!0,r=this.getElementContainer()){t.next=24;break}return t.abrupt("return");case 24:if(!this.gateway.shouldCreateElement(r)){t.next=40;break}if(!(r instanceof NodeList)){t.next=36;break}i=0;case 27:if(!(i<r.length)){t.next=34;break}return o=r[i],t.next=31,this.gateway.createPaymentElement(o);case 31:i++,t.next=27;break;case 34:t.next=38;break;case 36:return t.next=38,this.gateway.createPaymentElement(r);case 38:this.$paymentElement=e()(r),this.onPaymentElementReady();case 40:case"end":return t.stop()}}),t,this,[[6,12]])}))),function(){return c.apply(this,arguments)})},{key:"getPaymentElement",value:function(){return this.$paymentElement}},{key:"destroyPaymentElement",value:function(){var t,e;null===(t=(e=this.gateway).destroyPaymentElement)||void 0===t||t.call(e)}},{key:"disablePaymentElement",value:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(t=(e=this.gateway).disablePaymentElement)||void 0===t||t.call(e),n&&null!=this&&this.$paymentElement&&this.$paymentElement.addClass("disabled")}},{key:"enablePaymentElement",value:function(){var t,e;null===(t=(e=this.gateway).enablePaymentElement)||void 0===t||t.call(e),this.$paymentElement&&this.$paymentElement.removeClass("disabled")}},{key:"displayPaymentElement",value:function(){var t;null===(t=this.getPaymentElement())||void 0===t||t.show()}},{key:"hidePaymentElement",value:function(){var t;null===(t=this.getPaymentElement())||void 0===t||t.hide()}},{key:"needsShipping",value:function(){return this.cart.needsShipping()}},{key:"getElementContainer",value:function(){return null}},{key:"onPaymentUnavailable",value:function(){}},{key:"onPaymentElementReady",value:function(){this.actions.doAction("payment_element_ready",this)}},{key:"onCancel",value:function(t,n){this.orderId=(null==t?void 0:t.orderID)||null,this.enablePaymentElement(),e()(document.body).triggerHandler("wc_ppcp_on_cancel",[this,n,t])}},{key:"onError",value:function(t,n){this.currentError?(this.submitError(this.currentError),this.currentError=null):this.submitError(t),this.enablePaymentElement(),e()(document.body).triggerHandler("wc_ppcp_on_error",[this,n,t])}},{key:"fetchBillingToken",value:function(t){return o()({method:"GET",path:"/wc-ppcp/v1/billing-agreement/token/".concat(t)})}},{key:"createPaymentToken",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o()({method:"POST",path:"/wc-ppcp/v1/vault/payment-tokens",data:m({setup_token:t},e)})}},{key:"handlePaymentToken",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.setFieldValue)("".concat(this.id,"_payment_token"),t,null),this.submit(e)}},{key:"createOrder",value:function(t,e){var n=this;return this.cart.createOrder(m(m({},t),{},{payment_method:this.id})).catch((function(t){return n.currentError=t,t}))}},{key:"createVaultSetupToken",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.disablePaymentElement(!0),o()({method:"POST",url:(0,a.getRestPath)("/wc-ppcp/v1/vault/setup-tokens"),data:m({context:this.context.getPage(),payment_method:this.id},e)}).then((function(t){return t.id})).catch((function(e){throw t.currentError=e,t.enablePaymentElement(),e}))}},{key:"onShippingChange",value:function(t){return this.cart.updateShipping(m({payment_method:this.id},t)).then((function(t){return t})).catch((function(t){throw t}))}},{key:"submitError",value:function(t){}},{key:"getShippingPrefix",value:function(){return"shipping"}},{key:"getCartAddress",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{address_1:(0,a.getFieldValue)("address_1",t,e),address_2:(0,a.getFieldValue)("address_2",t,e),state:(0,a.getFieldValue)("state",t,e),city:(0,a.getFieldValue)("city",t,e),postcode:(0,a.getFieldValue)("postcode",t,e),country:(0,a.getFieldValue)("country",t,e)}}},{key:"getCartFullAddress",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{first_name:(0,a.getFieldValue)("first_name",t,e),last_name:(0,a.getFieldValue)("last_name",t,e),address_1:(0,a.getFieldValue)("address_1",t,e),address_2:(0,a.getFieldValue)("address_2",t,e),state:(0,a.getFieldValue)("state",t,e),city:(0,a.getFieldValue)("city",t,e),postcode:(0,a.getFieldValue)("postcode",t,e),country:(0,a.getFieldValue)("country",t,e)}}},{key:"onClick",value:function(){this.storeAttributionValues()}},{key:"validate",value:(i=w(g().mark((function t(){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!0);case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"populateCheckoutFields",value:function(t){var e=this.actions.applyFilters("field_population_options",{skipShipping:!1,needsShipping:this.needsShipping()},this);this.fields.populate(t,e),this.actions.doAction("after_populate_checkout_fields",this)}},{key:"submit",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e&&this.populateCheckoutFields(e),this.showProcessing(),o()({method:"POST",url:(0,a.getRestRoute)("cart/checkout"),data:this.getCartCheckoutData()}).then((function(e){if(e.result&&"success"==e.result)window.location=e.redirect;else if(e.messages)return t.submitError(e.messages)})).catch((function(e){e.code&&t.submitError(e.message)}))}},{key:"getCartCheckoutData",value:function(){return m({payment_method:this.id,context:this.context.getPage()},(0,a.fieldsToJson)())}},{key:"getProcessingSelector",value:function(){return"body"}},{key:"showProcessing",value:function(){var t;null===(t=e()(this.getProcessingSelector()))||void 0===t||t.block({message:this.getProcessingMessage(),overlayCSS:{background:"#fff",opacity:.6}})}},{key:"hideProcessing",value:function(){var t;null===(t=e()(this.getProcessingSelector()))||void 0===t||t.unblock()}},{key:"getProcessingMessage",value:function(){return'<div class="wc-ppcp-loader">\n                        <div></div>\n                        <div></div>\n                        <div></div>\n                      </div>'}},{key:"getFullName",value:function(t){var e=[(0,a.getFieldValue)("first_name",t),(0,a.getFieldValue)("last_name",t)].filter(Boolean);return 0==e.length?null:1==e.length?e[0]:"".concat(e[0]," ").concat(e[1])}},{key:"updateGatewaySettings",value:function(t){var e="".concat(this.id,"_data");t[e]&&(this.gateway.settings=m(m({},this.gateway.settings),t[e]))}},{key:"isOrderAttributionEnabled",value:function(){return"undefined"!=typeof wc_order_attribution&&null!==document.querySelector("wc-order-attribution-inputs")}},{key:"storeAttributionValues",value:function(){if(!t.attributionDataStored&&!this.context.isCheckout()&&this.isOrderAttributionEnabled()){var n=wc_order_attribution.params.prefix;e()('input[type="hidden"][name^="'+n+'"]').each((function(t,n){var r=e()(n),i=r.attr("name");(0,a.setFieldValue)(i,r.val(),null)})),t.attributionDataStored=!0}}}],r&&_(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();k(P,"attributionDataStored",!1);const E=P;function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S(){return S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=j(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},S.apply(this,arguments)}function j(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}function C(t,e){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},C(t,e)}function F(t,e){if(e&&("object"===O(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(u,t);var n,r,i,o,c=(i=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=T(i);if(o){var n=T(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return F(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=c.call(this,e)).product=t,n}return n=u,r=[{key:"initialize",value:function(){this.actions.addAction("found_variation",this.onFoundVariation.bind(this)),this.actions.addAction("reset_variation",this.onResetVariation.bind(this)),this.setMaxWidth(),S(T(u.prototype),"initialize",this).call(this)}},{key:"onPaymentElementReady",value:function(){var t,e;S(T(u.prototype),"onPaymentElementReady",this).call(this),this.product.isVariableProduct()&&(this.product.isVariationSelected()&&null!==(t=this.product)&&void 0!==t&&null!==(e=t.variation)&&void 0!==e&&e.is_in_stock?this.enablePaymentElement():this.disablePaymentElement(!0))}},{key:"needsShipping",value:function(){return this.cart.isEmpty()?this.product.needsShipping():this.cart.needsShipping()}},{key:"getElementContainer",value:function(){var t="wc-".concat(this.id,"-product-button-container"),e=document.querySelectorAll(".".concat(t));return e&&e.length>0?e:document.getElementById(t)}},{key:"setMaxWidth",value:function(){var t,n;if("add_to_cart"==(null===(t=this.settings)||void 0===t||null===(n=t.product)||void 0===n?void 0:n.button_width)){this.buttonWidth=e()("form.cart div.quantity").outerWidth(!0)+e()(".single_add_to_cart_button").outerWidth();var r=e()(".single_add_to_cart_button").css("marginLeft");r&&(this.buttonWidth+=parseInt(r.replace("px",""))),e()(this.container).css("max-width",this.buttonWidth+"px")}}},{key:"submitError",value:function(t){this.hideProcessing(),(0,a.submitErrorMessage)(t,"div.woocommerce-notices-wrapper")}},{key:"addToCart",value:function(){var t=this;return this.cart.addToCart({payment_method:this.id,product_id:this.product.getId(),variation_id:this.product.getVariationId(),qty:this.product.getQuantity(),variation:this.product.getVariationData(),needs_setup_token:this.settings.needsSetupToken}).then((function(e){if(!e.code)return t.updateGatewaySettings(e.payment_methods),e.order_id;t.currentError=e})).catch((function(e){return t.currentError=e,t.submitError(e)}))}},{key:"createOrder",value:function(){return this.addToCart()}},{key:"createVaultSetupToken",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.addToCart().then((function(){return S(T(u.prototype),"createVaultSetupToken",t).call(t,e)}))}},{key:"handlePaymentToken",value:function(t){S(T(u.prototype),"handlePaymentToken",this).call(this,t),this.submit()}},{key:"onFoundVariation",value:function(t,e){t?(this.destroyPaymentElement(),this.createPaymentElement()):e.variation.is_in_stock?this.enablePaymentElement():this.disablePaymentElement(!0)}},{key:"onResetVariation",value:function(){this.disablePaymentElement(!0)}}],r&&x(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),u}(E);function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function V(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function M(){return M="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=B(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},M.apply(this,arguments)}function B(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=N(t)););return t}function D(t,e){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},D(t,e)}function G(t,e){if(e&&("object"===R(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function N(t){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},N(t)}var q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&D(t,e)}(u,t);var n,r,i,o,c=(i=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=N(i);if(o){var n=N(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return G(this,t)});function u(){return V(this,u),c.apply(this,arguments)}return n=u,(r=[{key:"initialize",value:function(){this.actions.addAction("cart_updated",this.onCartUpdated.bind(this)),e()(window).on("resize",this.doCartHtml.bind(this)),e()(document).on("change",'input[name^="shipping_method"]',this.onShippingSelected.bind(this)),M(N(u.prototype),"initialize",this).call(this),this.doCartHtml()}},{key:"getElementContainer",value:function(){return document.getElementById("wc-".concat(this.id,"-cart-button-container"))}},{key:"onCartUpdated",value:function(t){M(N(u.prototype),"initialize",this).call(this),this.doCartHtml(),this.updateGatewaySettings(t)}},{key:"onShippingSelected",value:function(){this.storeAttributionValues()}},{key:"submitError",value:function(t){this.hideProcessing(),(0,a.submitErrorMessage)(t,"div.woocommerce-notices-wrapper","checkout")}},{key:"doCartHtml",value:function(){var t=e()(".checkout-button"),n=t.outerWidth();n&&e()(".wc-ppcp-cart-payments__container").length&&e()(".wc-ppcp-cart-payments__container").width(n),"none"!==t.css("float")&&e()(".wc-ppcp-cart-payments__container ").css("float",t.css("float"))}}])&&A(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),u}(E);const I=window.wcPPCP.paymentMethods;var z=n(863);function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){Y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $(){$=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof h?e:h,o=Object.create(i.prototype),a=new P(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var c=w(a,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=s(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function s(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var l={};function h(){}function d(){}function p(){}var f={};c(f,i,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(E([])));v&&v!==e&&n.call(v,i)&&(f=v);var m=p.prototype=h.prototype=Object.create(f);function g(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(i,o,a,c){var u=s(t[i],t,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==U(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;this._invoke=function(t,n){function o(){return new e((function(e,i){r(t,n,e,i)}))}return i=i?i.then(o,o):o()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=s(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function E(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return d.prototype=p,c(m,"constructor",p),c(p,"constructor",d),d.displayName=c(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},g(b.prototype),c(b.prototype,o,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(m),c(m,a,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=E,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function K(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function Q(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){K(o,r,i,a,c,"next",t)}function c(t){K(o,r,i,a,c,"throw",t)}a(void 0)}))}}function J(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function X(){return X="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Z(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},X.apply(this,arguments)}function Z(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=nt(t)););return t}function tt(t,e){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tt(t,e)}function et(t,e){if(e&&("object"===U(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function nt(t){return nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nt(t)}var rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tt(t,e)}(d,t);var n,r,i,u,s,l,h=(s=d,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=nt(s);if(l){var n=nt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return et(this,t)});function d(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(e=h.call(this,t)).shippingAddressChanged=!1,e.promises=[],e}return n=d,r=[{key:"initialize",value:function(){X(nt(d.prototype),"initialize",this).call(this),this.actions.addAction("updated_checkout",this.updatedCheckout.bind(this)),e()(document.body).on("update_checkout",this.updateCheckout.bind(this)),this.context.isCheckout()?(e()(document.body).on("payment_method_selected",this.paymentMethodSelected.bind(this)),e()("form.checkout").on("checkout_place_order_".concat(this.id),this.onCheckoutPlaceOrder.bind(this))):(e()(document.body).on("change",'input[name="payment_method"]',this.paymentMethodSelected.bind(this)),e()(document.body).on("click","#place_order",this.onClickPlaceOrder.bind(this))),e()(document.body).on("checkout_error",this.onCheckoutError.bind(this)),e()(document.body).on("click",".wc-".concat(this.gateway.id,"-cancel__payment"),this.cancelPayment.bind(this)),e()(document.body).on("change",'[name="terms"]',this.handleTermsClick.bind(this)),e()(document.body).on("change",'[type="checkbox"]',this.handleCheckboxChange.bind(this)),e()(document.body).on("change",'[name="wc-'.concat(this.id,'-payment-token"]'),this.onPaymentTokenClick.bind(this)),window.addEventListener("hashchange",this.handleHashError.bind(this)),this.handleOrderPay()}},{key:"createPaymentElement",value:(u=Q($().mark((function t(){var e=this;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.promises);case 2:if(this.promises=[],!this.context.isCheckout()||this.isEnabledForCheckoutSection()){t.next=6;break}return this.hidePaymentMethodRow(),t.abrupt("return");case 6:X(nt(d.prototype),"createPaymentElement",this).call(this).then((function(){e.paymentMethodSelected()}));case 7:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"isEnabledForCheckoutSection",value:function(){var t,e,n;return null===(t=null===(e=this.gateway.settings)||void 0===e||null===(n=e.sections)||void 0===n?void 0:n.includes("checkout"))||void 0===t||t}},{key:"hidePaymentMethodRow",value:function(){e()("form.checkout li.payment_method_".concat(this.id)).hide()}},{key:"onPaymentUnavailable",value:function(){var t,n,r,i;if(this.configurationError){var o=(0,a.isAdminUser)()?(null===(t=this.gateway.settings)||void 0===t||null===(n=t.i18n)||void 0===n?void 0:n.unavailable_admin)||this.configurationError:(null===(r=this.gateway.settings)||void 0===r||null===(i=r.i18n)||void 0===i?void 0:i.unavailable)||"Payment method unavailable",c=e()("div.payment_method_".concat(this.id)).find(".wc-".concat(this.id,"-payment-method__container"));c.find(".woocommerce-info").remove(),c.prepend('<div class="woocommerce-info"><p>'.concat(o,"</p></div>"))}else this.hidePaymentMethodRow()}},{key:"needsShipping",value:function(){return!this.context.isOrderPay()&&!this.context.isAddPaymentMethod()&&this.cart.needsShipping()}},{key:"updatedCheckout",value:function(t){X(nt(d.prototype),"initialize",this).call(this),this.updateGatewaySettings(t),this.paymentMethodSelected(),(this.isOrderReview()||this.isReadyToCheckout())&&this.displayPaymentReadyMessage()}},{key:"updateCheckout",value:function(){this.promises.push(new Promise((function(t){e()(document.body).one("updated_checkout",(function(){t()}))})))}},{key:"paymentMethodSelected",value:function(){if(this.isPaymentGatewaySelected()){if(!this.isPaymentMethodAvailable)return void this.displayPlaceOrderButton();this.gateway.supports("place_order_button")?(this.displayPlaceOrderButton(),this.isReadyToCheckout()&&this.isPaymentSectionPlacement()&&this.hidePaymentElement()):this.isReadyToCheckout()||this.isSavedPaymentMethodSelected()?this.displayPlaceOrderButton():(this.displayPaymentElement(),this.hidePlaceOrderButton())}else if(!this.gateway.supports("place_order_button")){var t;this.hidePaymentElement();var n=null===(t=e()('[name="payment_method"]:checked'))||void 0===t?void 0:t.val();n&&!(0,I.getPaymentMethod)(n)&&this.displayPlaceOrderButton()}}},{key:"handleHashError",value:function(t){var e=t.newURL.match(/ppcp_error=(.*)/);e&&"true"==e[1]&&(this.displayPaymentElement(),history.pushState({},"",window.location.pathname+window.location.search))}},{key:"isOrderReview",value:function(){var t,e,n,r=null===(t=window)||void 0===t||null===(e=t.location)||void 0===e||null===(n=e.search)||void 0===n?void 0:n.match(/_ppcp_order_review=(.*)/);return(null==r?void 0:r.length)>0}},{key:"handleOrderPay",value:function(){if(this.isOrderReview())try{var t,n,r,i,o=(null===(t=window)||void 0===t||null===(n=t.location)||void 0===n||null===(r=n.search)||void 0===r?void 0:r.match(/_ppcp_order_review=(.*)/))[1],u=JSON.parse(atob(decodeURIComponent(o))),s=(u.payment_method,u.paypal_order),l=u.fields;if((0,a.setFieldValue)(this.order_field_key,s,""),!(0,c.isEmpty)(l))for(var h in l)(0,a.setFieldValue)(h,l[h],"");if(this.hidePaymentElement(),this.needsShipping()&&null!==(i=e()('[name="ship_to_different_address"]'))&&void 0!==i&&i.length){var d=!(0,c.isEqual)(this.getCartAddress("billing"),this.getCartAddress("shipping"));e()('[name="ship_to_different_address"]').prop("checked",d).trigger("change")}}catch(t){console.log(t)}}},{key:"createOrder",value:function(t,e){if(this.context.isOrderPay())return this.cart.doOrderPay(this.id);var n=W(W({},this.convertFormToData()),{},{context:this.context.getPage(),payment_method:this.id});return this.cart.createOrder(n)}},{key:"createVaultSetupToken",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.context.isOrderPay()||(t=W(W({},this.convertFormToData()),{},{context:this.context.getPage(),payment_method:this.id})),X(nt(d.prototype),"createVaultSetupToken",this).call(this,t)}},{key:"displayPlaceOrderButton",value:function(){var t;null===(t=this.getPlaceOrderButton())||void 0===t||t.removeClass("wc-ppcp-hide-button")}},{key:"hidePlaceOrderButton",value:function(){var t;null===(t=this.getPlaceOrderButton())||void 0===t||t.addClass("wc-ppcp-hide-button")}},{key:"getPlaceOrderButton",value:function(){var t=e()("#place_order");return t.length||(t=e()('[name="woocommerce_checkout_place_order"]')),t.length||(t=e()('form.checkout button[type="submit"]')),t.length||(t=e()('form[id="order_review"] button[type="submit"]')),t}},{key:"getButtonPlacement",value:function(){var t;return(null===(t=this.settings)||void 0===t?void 0:t.buttonPlacement)||"place_order"}},{key:"isPlaceOrderPlacement",value:function(){return"place_order"===this.getButtonPlacement()}},{key:"isPaymentSectionPlacement",value:function(){return"payment_method"===this.getButtonPlacement()}},{key:"getElementContainer",value:function(){if(this.paymentElementSelector)return document.querySelector(this.paymentElementSelector);var t=this.getButtonPlacement(),n="wc-".concat(this.id,"-checkout-container"),r=".".concat(n),i="place_order"===t&&!this.gateway.supports("place_order_button");return document.querySelector(r)||(i?this.getPlaceOrderButton().after('<div class="'.concat(n,'"></div>')):"payment_method"===t&&e()("div.payment_method_".concat(this.id)).find(".wc-".concat(this.id,"-payment-method__container")).append('<div class="'.concat(n,'"></div>'))),i&&e()(r).hide(),document.querySelector(r)}},{key:"isPaymentGatewaySelected",value:function(){var t;return(null===(t=e()('[name="payment_method"]:checked'))||void 0===t?void 0:t.val())===this.id}},{key:"submitError",value:function(t){return"validation_errors"===(null==t?void 0:t.code)?(this.getForm().find(".input-text, select, input:checkbox").trigger("validate").trigger("blur"),(0,a.submitErrorMessage)(t.data.messages,this.getForm(),"checkout")):(0,a.submitErrorMessage)(t,this.getForm(),"checkout")}},{key:"getShippingPrefix",value:function(){var t;return null!==(t=e()('[name="ship_to_different_address"]'))&&void 0!==t&&t.length&&e()('[name="ship_to_different_address"]').is(":checked")?"shipping":"billing"}},{key:"handlePaymentToken",value:function(t,e){this.update_required=this.isCheckoutReviewRequired(t),X(nt(d.prototype),"handlePaymentToken",this).call(this,t,W({vaultSetupToken:!0},e))}},{key:"isCheckoutReviewRequired",value:function(t){return!(!this.needsShipping()||!this.actions.applyFilters("is_checkout_review_required",!this.shippingAddressChanged,this)||(0,c.isEmpty)(t.shipping_address)||(0,c.isEqual)({city:t.shipping_address.city,state:t.shipping_address.state,postal_code:t.shipping_address.postal_code,country_code:t.shipping_address.country_code},{city:(0,a.getFieldValue)("shipping_city"),state:(0,a.getFieldValue)("shipping_state"),postal_code:(0,a.getFieldValue)("shipping_postcode"),country_code:(0,a.getFieldValue)("shipping_country")}))}},{key:"getForm",value:function(){return this.context.isCheckout()||this.context.isExpressCheckout()?e()(this.container).closest("form.checkout"):e()(this.container).closest("form")}},{key:"validateTerms",value:function(){return!e()('[name="terms"]').filter(":visible").length||e()('[name="terms"]').is(":checked")}},{key:"onClickPlaceOrder",value:function(t){this.isPaymentGatewaySelected()&&(this.onCheckoutPlaceOrder(t,null)||t.preventDefault())}},{key:"onCheckoutPlaceOrder",value:function(t){var e,n,r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isSavedPaymentMethodSelected())return!0;if(this.isReadyToCheckout()||null!==(e=(n=this.gateway).isPaymentReady)&&void 0!==e&&e.call(n))return!0;if(!this.validateSync())return!1;if(this.gateway.supports("place_order_button")&&this.isPaymentSectionPlacement()&&!this.isReadyToCheckout())return this.submitError((0,z.getErrorMessage)({code:"order_button_click"}).replace("%s",this.gateway.settings.title)),!1;try{this.gateway.validatePaymentElement()}catch(t){return this.submitError(t),!1}return!this.gateway.supports("create_payment_method")||(this.gateway.createPaymentMethod(i).catch((function(t){r.submitError(t)})),!1)}},{key:"isTermsVisible",value:function(){return e()('[name="terms"]').filter(":visible").length>0}},{key:"handleTermsClick",value:function(){this.isPlaceOrderPlacement()&&e()('[name="terms"]').length&&(e()('[name="terms"]').is(":checked")?this.enablePaymentElement():this.disablePaymentElement())}},{key:"handleCheckboxChange",value:function(){var t=this;setTimeout((function(){t.isTermsVisible()&&t.handleTermsClick()}),250)}},{key:"onPaymentTokenClick",value:function(t){this.isSavedPaymentMethodSelected()?(this.hidePaymentElement(),this.displayPlaceOrderButton()):(this.displayPaymentElement(),this.gateway.supports("place_order_button")||this.hidePlaceOrderButton())}},{key:"validateSync",value:function(){if(this.isPlaceOrderPlacement()&&!this.validateTerms())return this.submitError({code:"terms"}),!1;if(this.gateway.supports("form_validation")){var t=this.getForm();t.find(".input-text, select, input:checkbox").filter(":visible").trigger("validate").trigger("blur");var e=t.find(".form-row.woocommerce-invalid:visible");if(this.actions.applyFilters("checkout_form_validation_has_errors",e.length>0,e,this))return this.submitError({code:"required_fields"}),!1}return!0}},{key:"validate",value:(i=Q($().mark((function t(){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.validateSync()){t.next=2;break}return t.abrupt("return",!1);case 2:if(!this.gateway.supports("api_form_validation")){t.next=12;break}return t.prev=3,t.next=6,this.apiFormValidation();case 6:t.next=12;break;case 8:return t.prev=8,t.t0=t.catch(3),this.submitError(t.t0),t.abrupt("return",!1);case 12:return t.abrupt("return",!0);case 13:case"end":return t.stop()}}),t,this,[[3,8]])}))),function(){return i.apply(this,arguments)})},{key:"onShippingChange",value:function(t){var n;if(null!==(n=t)&&void 0!==n&&n.shipping_method)for(var r=(0,a.extractShippingMethod)(t.shipping_method),i=0,o=Object.keys(r);i<o.length;i++){var u=o[i],s=r[u],l=e()('[name="shipping_method['.concat(u,']"][value="').concat(s,'"]'));l.length?l.prop("checked",!0):this.update_required=!0}return t.address&&(this.shippingAddressChanged=!(0,c.isEqual)(t.address,{city:(0,a.getFieldValue)("shipping_city"),state:(0,a.getFieldValue)("shipping_state"),postcode:(0,a.getFieldValue)("shipping_postcode"),country:(0,a.getFieldValue)("shipping_country")})),t=W(W({},t),this.convertFormToData()),this.actions.doAction("checkout_on_shipping_change",t,this),X(nt(d.prototype),"onShippingChange",this).call(this,t)}},{key:"displayPaymentReadyMessage",value:function(){e()(".wc-".concat(this.gateway.id,"-popup__container")).hide(),e()(".wc-".concat(this.gateway.id,"-order-review-message__container")).show();var t=e()(".wc-".concat(this.gateway.id,"-order-review__message")).text().replace("%s",e()("#place_order").text());e()(".wc-".concat(this.gateway.id,"-order-review__message")).text(t)}},{key:"hidePaymentReadyMessage",value:function(){e()(".wc-".concat(this.gateway.id,"-popup__container")).show(),e()(".wc-".concat(this.gateway.id,"-order-review-message__container")).hide()}},{key:"cancelPayment",value:function(t){t.preventDefault(),(0,a.setFieldValue)(this.order_field_key,"",""),(0,a.setFieldValue)("".concat(this.gateway.id,"_payment_token"),null,null),this.hidePaymentReadyMessage(),this.displayPaymentElement(),this.gateway.supports("place_order_button")||this.hidePlaceOrderButton()}},{key:"getProcessingSelector",value:function(){return this.container}},{key:"getProcessingMessage",value:function(){return null}},{key:"fetchBillingToken",value:function(t){var e=this;return this.showProcessing(),X(nt(d.prototype),"fetchBillingToken",this).call(this,t).then((function(t){return e.hideProcessing(),t}))}},{key:"isReadyToCheckout",value:function(){return!(!(0,a.getFieldValue)(this.order_field_key,null)&&!(0,a.getFieldValue)("".concat(this.gateway.id,"_payment_token"),null))}},{key:"convertFormToData",value:function(){return e()("form.checkout").serializeArray().reduce((function(t,e){return W(W({},t),{},Y({},e.name,e.value))}),{})}},{key:"submit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&this.populateCheckoutFields(t),this.gateway.supports("create_payment_method")||(this.hidePaymentElement(),this.displayPlaceOrderButton()),this.update_required?this.triggerCheckoutUpdate(t):(this.isPaymentSectionPlacement()&&!this.context.isExpressCheckout()||this.submitForm(t),this.isPaymentSectionPlacement()&&this.displayPaymentReadyMessage())}},{key:"triggerCheckoutUpdate",value:function(t){var n=this;return new Promise((function(r){e()(document.body).one("updated_checkout",(function(){null!=t&&t.vaultSetupToken&&n.needsShipping()?n.displayPaymentReadyMessage():n.submitForm(t),r()})),e()('[name="billing_country"],[name="billing_state"]').trigger("change"),n.shipToDifferentAddressChecked()&&e()('[name="shipping_country"],[name="shipping_state"]').trigger("change"),e()(document.body).trigger("update_checkout",{update_shipping_method:!1})}))}},{key:"submitForm",value:function(t){this.actions.applyFilters("checkout_submit_form",!0,t,this)&&this.getForm().submit()}},{key:"shipToDifferentAddressChecked",value:function(){var t;return!(null===(t=e()('[name="ship_to_different_address"]'))||void 0===t||!t.length)&&e()('[name="ship_to_different_address"]').is(":checked")}},{key:"getPaymentType",value:function(){return"checkout"}},{key:"isValidationEnabled",value:function(){return this.settings.checkoutValidationEnabled}},{key:"isSavedPaymentMethodSelected",value:function(){var t='[name="wc-'.concat(this.id,'-payment-token"]:checked');return this.isPaymentGatewaySelected()&&e()(t).length>0&&"new"!==e()(t).val()}},{key:"apiFormValidation",value:function(){var t=W(W({},this.convertFormToData()),{},{context:this.context.getPage(),payment_method:this.id});return o()({method:"POST",url:(0,a.getRestRoute)("checkout/validation"),data:t}).catch((function(t){throw t}))}},{key:"onCheckoutError",value:function(){this.isPaymentGatewaySelected()&&(this.enablePlaceOrderButton(),this.isReadyToCheckout()&&this.displayPaymentReadyMessage(),this.actions.doAction("checkout_error_".concat(this.gateway.id),this))}},{key:"enablePlaceOrderButton",value:function(){this.getPlaceOrderButton().prop("disabled",!1)}}],r&&J(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),d}(E);function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function ot(){ot=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof h?e:h,o=Object.create(i.prototype),a=new P(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var c=w(a,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=s(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function s(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var l={};function h(){}function d(){}function p(){}var f={};c(f,i,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(E([])));v&&v!==e&&n.call(v,i)&&(f=v);var m=p.prototype=h.prototype=Object.create(f);function g(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(i,o,a,c){var u=s(t[i],t,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==it(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;this._invoke=function(t,n){function o(){return new e((function(e,i){r(t,n,e,i)}))}return i=i?i.then(o,o):o()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=s(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function E(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return d.prototype=p,c(m,"constructor",p),c(p,"constructor",d),d.displayName=c(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},g(b.prototype),c(b.prototype,o,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(m),c(m,a,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=E,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function at(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function ct(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){at(o,r,i,a,c,"next",t)}function c(t){at(o,r,i,a,c,"throw",t)}a(void 0)}))}}function ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function st(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lt(){return lt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=ht(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},lt.apply(this,arguments)}function ht(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ft(t)););return t}function dt(t,e){return dt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},dt(t,e)}function pt(t,e){if(e&&("object"===it(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ft(t){return ft=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ft(t)}var yt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dt(t,e)}(c,t);var n,r,i,o,a=(i=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ft(i);if(o){var n=ft(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return pt(this,t)});function c(){return ut(this,c),a.apply(this,arguments)}return n=c,r=[{key:"initialize",value:function(){var t=this;this.actions.addAction("updated_checkout",this.updatedCheckout.bind(this)),this.loadPayPalScript().then(ct(ot().mark((function e(){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.createPaymentElement();case 1:case"end":return e.stop()}}),e)}))))}},{key:"updatedCheckout",value:function(t){this.paypal&&this.createPaymentElement(),this.updateGatewaySettings(t)}},{key:"needsShipping",value:function(){return this.cart.needsShipping()}},{key:"validate",value:function(){return!0}},{key:"submit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;lt(ft(c.prototype),"submit",this).call(this,t);var n=lt(ft(c.prototype),"getElementContainer",this).call(this);n&&e()(n).hide()}},{key:"getElementContainer",value:function(){var t;if(null!==(t=this.settings)&&void 0!==t&&t.expressElement){var e=document.querySelector(this.settings.expressElement);if(e)return e}return document.getElementById("wc-".concat(this.id,"-express-button"))}},{key:"onPaymentElementReady",value:function(){this.actions.doAction("payment_element_ready",this);var t=this.getElementContainer();t&&(e()(t).show(),this.addExpressClasses(e()(t)))}},{key:"addExpressClasses",value:function(t){if(t.length&&this.gateway.buttons){var e=Object.keys(this.gateway.buttons).length;t.addClass("button-count_".concat(e))}}},{key:"onClick",value:function(){e()('[name="terms"]').prop("checked",!0).trigger("change"),e()('[name="payment_method"][value="'.concat(this.id,'"]')).prop("checked",!0).trigger("click"),e()('[name="wc-'.concat(this.id,'-payment-token"][value="new"]')).trigger("click")}},{key:"paymentMethodSelected",value:function(){}},{key:"hidePaymentElement",value:function(){}}],r&&st(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),c}(rt);function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bt(){return bt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=wt(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},bt.apply(this,arguments)}function wt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Pt(t)););return t}function _t(t,e){return _t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_t(t,e)}function kt(t,e){if(e&&("object"===vt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Pt(t){return Pt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pt(t)}var Et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_t(t,e)}(c,t);var n,r,i,o,a=(i=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Pt(i);if(o){var n=Pt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return kt(this,t)});function c(){return mt(this,c),a.apply(this,arguments)}return n=c,(r=[{key:"initialize",value:function(){this.actions.addAction("fragments_changed",this.onFragmentsChanged.bind(this)),bt(Pt(c.prototype),"initialize",this).call(this)}},{key:"onFragmentsChanged",value:function(){this.cart.isEmpty()||bt(Pt(c.prototype),"initialize",this).call(this)}},{key:"getElementContainer",value:function(){var t=document.querySelectorAll(".wc-ppcp-minicart-".concat(this.id));return t&&t.length>0?t:(e()(".woocommerce-mini-cart__buttons").append('<a id="wc-ppcp-minicart-'.concat(this.id,'"></a>')),document.getElementById("wc-ppcp-minicart-".concat(this.id)))}}])&&gt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),c}(E)})(),(this.wcPPCP=this.wcPPCP||{}).controllers=r})();
//# sourceMappingURL=controllers.js.map
{"version":3,"file":"paylater-messaging.js","mappings":"mBACA,I,KCAwB,CAACA,IACH,oBAAXC,QAA0BA,OAAOC,aAC1CC,OAAOC,eAAeJ,EAASC,OAAOC,YAAa,CAAEG,MAAO,WAE7DF,OAAOC,eAAeJ,EAAS,aAAc,CAAEK,OAAO,GAAO,E,ICL9D,MAAM,EAA+BC,OAAW,GAAW,QCArD,EAA+BA,OAAW,GAAkB,eCA5D,EAA+BA,OAAW,GAAW,QCArD,EAA+BA,OAAW,GAAc,WCAxD,EAA+BA,OAAe,OAAS,M,unCCAxBA,OAAW,GAAY,SCwGxBC,EAAAA,EAAA,GAbI,CACpC,WAAc,GACd,UAAa,GACb,QAAW,GACX,UAAa,GACb,UAAa,GACb,KAAQ,GACR,MAAS,GACT,SAAY,GACZ,QAAW,GACX,MAAS,KAIkB,IAC3B,MAAS,MAGOC,EAAAA,EAAAA,YAAW,mBAAmBC,KCvGlD,IAAMC,GAAOF,EAAAA,EAAAA,YAAW,kBAElBG,EAAoB,SAAHC,GAAoC,IAA/BC,EAAID,EAAJC,KAClBC,GADkCF,EAAVG,WAAmBH,EAAPI,QACxBN,EAAKO,SACjBC,GAAKC,EAAAA,EAAAA,QAAO,MACXC,EAAcP,EAAdO,WACeC,EAAyBD,EAAxCE,cAAyBC,EAAeH,EAAfG,YAC1BC,ECGyB,SAACC,GAChC,I,IAA0CC,G,GAAdC,EAAAA,EAAAA,UAAS,M,EAAK,E,8zBAAnCH,EAAME,EAAA,GAAEE,EAASF,EAAA,GAQxB,OANAG,EAAAA,EAAAA,YAAU,WACDL,IACDM,EAAAA,EAAAA,eAAcL,GAAQM,MAAK,SAAAP,GAAM,OAAII,EAAUJ,EAAO,GAE9D,GAAG,CAACA,IAEGA,CACX,CDbmBQ,EAAoBxB,EAAAA,EAAAA,YAAW,sBAExCyB,GAAUC,EAAAA,EAAAA,UAAQ,WACpB,O,+VAAA3B,CAAA,CACI4B,OAAQZ,EAAWa,KAAAC,IAAI,GAAMjB,EAAWkB,qBACxCjB,SAAAA,EACAkB,UAAW,WACR7B,EAAKuB,QAEhB,IAYA,OAVAJ,EAAAA,EAAAA,YAAU,WACFL,GAAUV,GACVU,EAAOgB,SAASP,GAASQ,OAAOvB,EAAGwB,QAE3C,GAAG,CACClB,EACAS,EACAnB,IAGAA,EAEI6B,MAAAC,cAACC,EAAAA,cAAa,KACVF,MAAAC,cAAA,OAAKE,UAAU,mCACXH,MAAAC,cAAA,OAAKG,IAAK7B,EAAI4B,UAAU,sCAKjC,IACX,GAUAE,EAAAA,EAAAA,gBAAe,UAAW,CAACP,OARZ,WACX,OACIE,MAAAC,cAACK,EAAAA,sBAAqB,KAClBN,MAAAC,cAACjC,EAAiB,MAG9B,EAEmCuC,MAAO,0B","sources":["webpack://wcPPCP/webpack/bootstrap","webpack://wcPPCP/webpack/runtime/make namespace object","webpack://wcPPCP/external window [\"wp\",\"element\"]","webpack://wcPPCP/external window [\"wc\",\"blocksCheckout\"]","webpack://wcPPCP/external window [\"wp\",\"plugins\"]","webpack://wcPPCP/external window [\"wc\",\"wcSettings\"]","webpack://wcPPCP/external window [\"wcPPCP\",\"utils\"]","webpack://wcPPCP/external window [\"wp\",\"apiFetch\"]","webpack://wcPPCP/./packages/blocks/assets/js/utils.js","webpack://wcPPCP/./packages/blocks/assets/js/paylater-messaging/index.js","webpack://wcPPCP/./packages/blocks/assets/js/hooks/use-load-paypal-script.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"element\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wc\"][\"blocksCheckout\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"plugins\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wc\"][\"wcSettings\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wcPPCP\"][\"utils\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"apiFetch\"];","import {SHIPPING_OPTION_REGEX} from '@ppcp/utils';\nimport {getSetting} from '@woocommerce/settings';\n\nexport const getShippingOptionId = (packageId, rateId) => `${packageId}:${rateId}`;\n\nexport const getSelectedShippingOptionId = (shippingRates) => {\n    let shippingOption = '';\n    shippingRates.forEach((shippingPackage, idx) => {\n        shippingPackage.shipping_rates.forEach(rate => {\n            if (rate.selected) {\n                shippingOption = getShippingOptionId(idx, rate.rate_id);\n            }\n        });\n    });\n    return shippingOption;\n}\n\nexport const extractShippingRateParams = (id) => {\n    const result = id.match(SHIPPING_OPTION_REGEX);\n    if (result) {\n        const {1: packageIdx, 2: rate} = result;\n        return [rate, packageIdx];\n    }\n    return [];\n}\n\nexport const removeNumberPrecision = (value, unit) => {\n    return value / 10 ** unit;\n}\n\nexport const hasShippingOptions = (shippingRates) => shippingRates.map(rate => rate?.shipping_rates.length > 0).filter(Boolean).length > 0;\n\n/**\n * Returns a rest route in ajax form given a route path.\n * @param path\n * @returns {*}\n */\nexport const getRestPath = (path) => {\n    path = path.replace(/^\\//, '');\n    return getSetting('ppcpGeneralData')?.ajaxRestPath?.replace('%s', path);\n}\n\nexport const isUserAdmin = () => getSetting('ppcpGeneralData')?.isAdmin\n\nconst getLocaleFields = (country) => {\n    const countryLocale = getSetting('countryLocale', {});\n    let localeFields = {...countryLocale.default};\n    if (country && countryLocale.hasOwnProperty(country)) {\n        localeFields = Object.entries(countryLocale[country]).reduce((locale, [key, value]) => {\n            locale[key] = {...locale[key], ...value}\n            return locale;\n        }, localeFields);\n    }\n    return localeFields;\n}\n\n/**\n * Returns true if the provided value is empty.\n * @param value\n * @returns {boolean}\n */\nconst isEmpty = (value) => {\n    if (typeof value === 'string') {\n        return value.length == 0 || value == '';\n    }\n    if (Array.isArray(value)) {\n        return array.length == 0;\n    }\n    if (typeof value === 'object') {\n        return Object.keys(value).length == 0;\n    }\n    if (typeof value === 'undefined') {\n        return true;\n    }\n    return true;\n}\n\nexport const isCartPage = () => {\n    return getSetting('ppcpGeneralData').context === 'cart';\n}\n\nexport const isCheckoutPage = () => {\n    return getSetting('ppcpGeneralData').context === 'checkout';\n}\n\nexport const isAdminOnly = () => {\n    return getSetting('ppcpGeneralData').adminOnly === true;\n}\n\nexport const isProduction = () => getSetting('ppcpGeneralData').environment === 'production';\n\nexport const DEFAULT_SHIPPING_ADDRESS = {\n    'first_name': '',\n    'last_name': '',\n    'company': '',\n    'address_1': '',\n    'address_2': '',\n    'city': '',\n    'state': '',\n    'postcode': '',\n    'country': '',\n    'phone': '',\n}\n\nexport const DEFAULT_BILLING_ADDRESS = {\n    ...DEFAULT_SHIPPING_ADDRESS,\n    'email': ''\n}\n\nexport const i18n = getSetting('ppcpGeneralData').i18n;","import {useEffect, useRef, useMemo} from '@wordpress/element';\nimport {ExperimentalOrderMeta, TotalsWrapper} from '@woocommerce/blocks-checkout';\nimport {registerPlugin} from '@wordpress/plugins';\nimport {getSetting} from '@woocommerce/settings';\nimport {useLoadPayPalScript} from \"../hooks\";\n\nconst data = getSetting('paylaterParams');\n\nconst PayLaterMessaging = ({cart, extensions, context}) => {\n    const isEnabled = data.enabled;\n    const el = useRef(null);\n    const {cartTotals} = cart;\n    const {currency_code: currency, total_price} = cartTotals;\n    const paypal = useLoadPayPalScript(getSetting('paypalQueryParams'));\n\n    const options = useMemo(() => {\n        return {\n            amount: total_price / (10 ** cartTotals.currency_minor_unit),\n            currency,\n            placement: 'payment',\n            ...data.options\n        }\n    });\n\n    useEffect(() => {\n        if (paypal && isEnabled) {\n            paypal.Messages(options).render(el.current);\n        }\n    }, [\n        paypal,\n        options,\n        isEnabled\n    ]);\n\n    if (isEnabled) {\n        return (\n            <TotalsWrapper>\n                <div className='wc-block-components-totals-item'>\n                    <div ref={el} className='wc-ppcp-paylater-msg__container'/>\n                </div>\n            </TotalsWrapper>\n        )\n    }\n    return null;\n}\n\nconst render = () => {\n    return (\n        <ExperimentalOrderMeta>\n            <PayLaterMessaging/>\n        </ExperimentalOrderMeta>\n    )\n}\n\nregisterPlugin('wc-ppcp', {render, scope: 'woocommerce-checkout'});\n","import {useEffect, useState} from \"@wordpress/element\";\nimport {loadPayPalSdk} from \"@ppcp/utils\";\n\n/*\n'client-id': this.getClientId(),\n'components': this.settings?.components,\n'currency': this.getOption('currency'),\n'intent': this.getOption('intent'),\n'vault': this.getOption('vault')\n */\n\n/**\n *\n * @param params - client-id, components, currency, intent, vault\n * @returns {*}\n */\nexport const useLoadPayPalScript = (params) => {\n    const [paypal, setPayPal] = useState(null);\n\n    useEffect(() => {\n        if (!paypal) {\n            loadPayPalSdk(params).then(paypal => setPayPal(paypal));\n        }\n    }, [paypal]);\n\n    return paypal;\n}"],"names":["exports","Symbol","toStringTag","Object","defineProperty","value","window","_objectSpread","getSetting","i18n","data","PayLaterMessaging","_ref","cart","isEnabled","extensions","context","enabled","el","useRef","cartTotals","currency","currency_code","total_price","paypal","params","_useState2","useState","setPayPal","useEffect","loadPayPalSdk","then","useLoadPayPalScript","options","useMemo","amount","Math","pow","currency_minor_unit","placement","Messages","render","current","React","createElement","TotalsWrapper","className","ref","registerPlugin","ExperimentalOrderMeta","scope"],"sourceRoot":""}